#!/bin/sh
#
# Pre-commit hook for sc2ts project
# Runs linting, type checking, and tests before allowing commit
#

echo "ğŸ” Running pre-commit checks..."

# Run lint with auto-fix
echo "ğŸ“ Running ESLint with auto-fix..."
pnpm run lint:fix || {
  echo "âŒ ESLint failed. Please fix the errors manually."
  exit 1
}

# Run type checking
echo "ğŸ” Running TypeScript type check..."
pnpm run typecheck || {
  echo "âŒ TypeScript type check failed. Please fix the type errors."
  exit 1
}

# Run tests
echo "ğŸ§ª Running tests..."
pnpm run test || {
  echo "âŒ Tests failed. Please fix the failing tests."
  exit 1
}

# Stage any files that were auto-fixed by lint
git add -u

echo "âœ… All pre-commit checks passed!"
exit 0